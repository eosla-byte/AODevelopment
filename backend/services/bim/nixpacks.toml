[phases.setup]
nixPkgs = ["python3", "postgresql", "curl", "gnutar", "gzip", "cacert"]
cmds = [
    "mkdir -p jdk",
    "curl -L https://github.com/adoptium/temurin17-binaries/releases/download/jdk-17.0.9%2B9/OpenJDK17U-jdk_x64_linux_hotspot_17.0.9_9.tar.gz -o jdk.tar.gz",
    "tar -xzf jdk.tar.gz -C jdk --strip-components=1",
    "rm jdk.tar.gz"
]

[start]
cmd = "JAVA_HOME=/app/jdk LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/app/jdk/lib/server uvicorn main:app --host 0.0.0.0 --port $PORT"
